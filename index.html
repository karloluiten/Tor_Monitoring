<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Tor monitoring by alienone</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Tor monitoring</h1>
        <h2>Tor Router &amp; Exit Node Monitoring</h2>
        <a href="https://github.com/alienone/Tor_Monitoring" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h3>Tor Router &amp; Exit Node Monitoring - ArcSight Use Case</h3>

<h4>Data Sources</h4>

<ul>
<li><a href="http://128.31.0.34:9031/tor/status/all">http://128.31.0.34:9031/tor/status/all</a></li>
<li><a href="http://exitlist.torproject.org/exit-addresses">http://exitlist.torproject.org/exit-addresses</a></li>
<li><a href="http://exitlist.torproject.org/exit-addresses.new">http://exitlist.torproject.org/exit-addresses.new</a></li>
</ul><h4>Installation &amp; Python Environment Configuration</h4>

<ul>
<li>curl -kL <a href="http://xrl.us/pythonbrewinstall">http://xrl.us/pythonbrewinstall</a> | bash</li>
<li>pythonbrew install 2.7.3</li>
<li>Add following environment variable setting to ~/.bashrc
<strong>[[ -s $HOME/.pythonbrew/etc/bashrc ]] &amp;&amp; source $HOME/.pythonbrew/etc/bashrc</strong>
</li>
<li>. .bashrc</li>
<li>pythonbrew use 2.7.3</li>
<li>pip install -r requirements.txt</li>
<li>python tor_get_current_router_nodes.py</li>
<li>ps -ef | grep tor_get_current_router_nodes.py # You should observe the script running as a daemon process</li>
<li>Script is configured to run every 24hrs</li>
</ul><h4>Use Case Description</h4>

<p>Harvest actively recorded Tor router and exit nodes. Tor anonymous routing services are often utilized by nefarious actors to conduct hacking operations against customers information systems infrastructure. Strategy is to daily update Active Lists within ArcSight SIEM in an effort to monitor and alert on any customer assets that may communicate with any known Tor router nodes. Additionally monitor and alert on any Tor Exit nodes that may communicate with the customer's information systems infrastructure.</p>

<h4>Collection &amp; Processing Methodology</h4>

<ul>
<li>Harvest Tor router and exit node data from data sources monitoring and updating on said registration of Tor assets.</li>
</ul><h4>Culled Attribute to ArcSight Mappings</h4>

<p><strong>Python Object - ArcSight Schema Field - Description</strong>
element - SourceAddress - None </p>

<p><strong>ArcSight CEF Mappings - Assignment - Description if Any</strong>
SourceAddress - Tor Router/Exit Node - None</p>

<ul>
<li>DeviceProduct =&gt; Tor Router Node/Tor Exit Node - None</li>
<li>DeviceVendor =&gt; Tor Exit Node/Tor Router Node - None</li>
<li>DeviceEventClassID =&gt; Exit Node/Router Node - None</li>
</ul><h4>ArcSight Content Development</h4>

<ul>
<li>Create Real Time Rule to populate Active List </li>
<li>Active List Composed of IPAddress - String</li>
<li>String assignment should be DeviceEventClassID</li>
<li>Create Real Time Rule to monitor outbound communications of customer assets with Tor Router Nodes </li>
<li>Create Real Time Rule to monitor inbound communications of customer assets SourceAddress</li>
</ul><h4>Long Term Deployment</h4>

<ul>
<li>Implementation runs as a daemon process on system</li>
</ul><h4>TODO</h4>

<ul>
<li>None at this point in time</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/alienone/Tor_Monitoring/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/alienone/Tor_Monitoring/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/alienone/Tor_Monitoring"></a> is maintained by <a href="https://github.com/alienone">alienone</a>.</p>

          <p>This page was generated by <a href="pages.github.com">GitHub Pages</a> using the Architect theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>